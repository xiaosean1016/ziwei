{extend name="../application/home/view/common/base.html"}

{block name="title_content"}
紫薇幼儿园-填写报名表
{/block}

{block name="lead_css"}
{load file="__admin__/plugins/bootstrap-inputmask/bootstrap-inputmask.min.js"}
{/block}

{block name="container"}
<div class="row-fluid" id="main">
    <div class="span8 offset2">
        <form id="signForm" class="form-horizontal ">
            <input type="hidden" name="id" value="{$SIGNID}">

            {$TEMPLATEHTML}

        </form>
        <div class="text-center">
            <button id="submitForm" class="btn btn-info waves-effect waves-light m-l-10">提交</button>
        </div>
    </div>
</div>
{/block}

{block name="lead_js"}
<script>
    function form_serialize (form) {
        if (!form || form.nodeName !== "FORM") {
            return;
        }
        var i, j, q = [];
        for (i = form.elements.length - 1; i >= 0; i = i - 1) {
            if (form.elements[i].name === "") {
                continue;
            }
            switch (form.elements[i].nodeName) {
                case 'INPUT':
                    switch (form.elements[i].type) {
                        case 'text':
                        case 'tel':
                        case 'email':
                        case 'hidden':
                        case 'password':
                        case 'button':
                        case 'reset':
                        case 'submit':
                            q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                            break;
                        case 'checkbox':
                        case 'radio':
                            if (form.elements[i].checked) {
                                q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                            }
                            break;
                    }
                    break;
                case 'file':
                    break;
                case 'TEXTAREA':
                    q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                    break;
                case 'SELECT':
                    switch (form.elements[i].type) {
                        case 'select-one':
                            q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                            break;
                        case 'select-multiple':
                            var options = [];
                            for (j = form.elements[i].options.length - 1; j >= 0; j = j - 1) {
                                if (form.elements[i].options[j].selected) {
                                    options.push(encodeURIComponent(form.elements[i].options[j].value));
                                }
                            }
                            q.push(form.elements[i].name + "=" + options);
                            break;
                    }
                    break;
                case 'BUTTON':
                    switch (form.elements[i].type) {
                        case 'reset':
                        case 'submit':
                        case 'button':
                            q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                            break;
                    }
                    break;
            }
        }
        return q.join("&");
    }

    $(function () {
        editValues({$SIGNID});

        $('#submitForm').on('click', function () {
            $.ajax({
                type: 'POST',
                url: '/home/SignUp/editSave',
                data: form_serialize(document.getElementById('signForm')),
                dateType: 'json',
                success: function (data) {
                    console.log(data);
                }
            });
        })
    });

    function editValues(id) {
        $.ajax({
            type: 'POST',
            url: 'getEditValue',
            data: {id: id},
            dataType: 'json',
            success: function (res) {
                var data = res.data;
                for (key in data) {
                    $('#signForm input[name="' + key + '"]').val(data[key]);
                }
            }
        })
    }

</script>
{/block}